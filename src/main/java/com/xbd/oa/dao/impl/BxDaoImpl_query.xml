<?xml version="1.0" encoding="UTF-8"?>
<query>
	<!--统计订单的及时率 -->
	<function name="list_timelyRateCount_by_sql" type="sql" sql="select oo.id,ood.id oa_order_detail,oo.wf_step_name,oo.wf_real_start,oo.wf_plan_start,oo.except_finish,oo.type,oo.wf_step_duration,oo.wf_step 
			from oa_order oo ,oa_order_detail ood
			where oo.id = ood.oa_order
			  and oo.oa_order_detail = ood.id 
			  and oo.wf_step != 'finish_999' and oo.status = '0' ${case}1">
		<parser index="1">
			<param fspname="type" sqlname="type"></param>
		</parser>
	</function>
	<!--统计各部门当前的订单数量 -->
	<function name="list_step_order_count_by_sql" sql="select wf_step_name,wf_step,count(id) stepCount from oa_order where wf_step!='finish_999'  and status='0' ${case}1 GROUP  by wf_step_name with rollup">
		<parser index="1">
			<param fspname="type" sqlname="type"></param>
			<param fspname="begin_time" sqlname="end_time" op="&gt;="></param>
			<param fspname="end_time" sqlname="end_time" op="&lt;"></param>
		</parser>
	</function>
	<!--统计各部门的提交时间 -->
	<function name="list_oa_order_detail_dahuotimelyrate_by_sql" type="sql" sql="select count(id) times, max(wf_real_finish) wf_real_finish,min(wf_real_finish) f_finish,max(wf_real_start) l_start,min(wf_real_start) f_start,oa_order,wf_step_duration from oa_order_detail
			 where 1=1 ${case}1 and oa_order in (select id from oa_order where status='0'and wf_step!='finish_999' ${case}2 ) ">
		<parser index="1">
			<param fspname="wfStep" sqlname="wf_step"></param>
			<param fspname="f_start" sqlname="wf_real_start" op="&gt;="></param>
			<param fspname="l_start" sqlname="wf_real_start" op="&lt;="></param>
		</parser>
		<parser index="2">
			<param fspname="type" sqlname="type"></param>
			<param fspname="order_id" sqlname="id"></param>
			<param fspname="begin_time" sqlname="end_time" op="&gt;="></param>
			<param fspname="end_time" sqlname="end_time" op="&lt;"></param>
		</parser>
	</function>
	<!--查找今天新增的订单 -->
	<function name="list_new_order_add_by_sql" type="sql" sql="select COUNT(id) orderToday from oa_order where 1=1 ${case}1">
		<parser index="1">
			<param fspname="type" sqlname="type"></param>
			<param fspname="orderBeginTime" sqlname="begin_time" op="&gt;="></param>
			<param fspname="orderTodayMaxTime" sqlname="begin_time" op="&lt;"></param>
		</parser>
	</function>
	<function name="list_oa_staff" type="sql" sql="select * from oa_staff  where 1=1 ${case}1 ">
		<parser index="1">
			<param fspname="login_name" sqlname="login_name" op="like"></param>
			<param fspname="oa_org" sqlname="oa_org"></param>
		</parser>
	</function>
	<function name="list_order_sql" type="sql" sql="select * from oa_order  where 1=1 ${case}1 ">
		<parser index="1">
			<param fspname="cus_code" sqlname="cus_code"></param>
			<param fspname="style_code" sqlname="style_code"></param>
			<param fspname="order_code" sqlname="order_code"></param>
			<param fspname="type" sqlname="type"></param>
			<param fspname="is_urgent" sqlname="is_urgent"></param>
			<param fspname="ppc" sqlname="ppc"></param>
			<param fspname="sales" sqlname="sales"></param>
		</parser>
	</function>
	<!-- 获取组织单位 -->
	<function name="get_oa_org" type="sql" sql="select * from oa_org where 1=1 ${case}1 ">
		<parser index="1">
			<param fspname="admin" sqlname="admin"></param>
		</parser>
	</function>
	<!-- 获取组织单位的员工 -->
	<function name="get_oa_staff" type="sql" sql="select * from oa_staff where 1=1 ${case}1 ">
		<parser index="1">
			<param fspname="oa_org" sqlname="oa_org"></param>
			<param fspname="login_name" sqlname="login_name" op="&lt;&gt;"></param>
		</parser>
	</function>
	<!-- 员工登录 -->
	<function name="login" type="eql" sql="select v from OaStaff v where 1=1 ${case}1">
		<parser index="1">
			<param fspname="id" sqlname="id"></param>
			<param fspname="loginName" sqlname="loginName"></param>
			<param fspname="password" sqlname="password"></param>
		</parser>
	</function>
	<function name="if_manager" type="eql" sql="select v from OaOrg v where 1=1 ${case}1">
		<parser index="1">
			<param fspname="name" sqlname="admin"></param>
		</parser>
	</function>
	<!-- 品类选择 -->
	<function name="get_category" type="sql" sql="select * from oa_category where status =1">
	</function>
	<!-- 处理订单 -->
	<function name="processorder" type="sql" sql="select o.sell_order_code,o.picture_front, a.id,a.oa_order,c.wf_step_name,c.operator top_operator,c.wf_real_finish,a.wf_plan_start,a.wf_real_start,a.wf_step_duration,a.wf_step,a.discrip,a.task_id,
		c.attachment top_attachment,c.pic top_pic,c.content top_content,a.attachment,a.pic,a.content,a.operator from oa_order_detail a,oa_order o,
		(select wf_step_name,operator,wf_real_finish,attachment,pic,content from oa_order_detail b,(select oa_order,inx from oa_order_detail where 1=1 ${case}1) a where b.oa_order=a.oa_order and b.inx=(a.inx-1)) c 
		where a.oa_order=o.id ${case}2">
		<parser index="1">
			<param fspname="id" sqlname="id"></param>
		</parser>
		<parser index="2">
			<param fspname="id" sqlname="a.id"></param>
		</parser>
	</function>
	<!--组织架构列表 -->
	<function name="list_oa_org_by_eql" type="eql" sql="select v from OaOrg v where 1=1 ${case}1">
		<parser index="1">
			<param fspname="id" sqlname="id"></param>
		</parser>
	</function>
	<!--人员列表 -->
	<function name="list_oa_staff_by_eql" type="eql" sql="select v from OaStaff v where 1=1 ${case}1">
		<parser index="1">
			<param fspname="id" sqlname="id"></param>
		</parser>
	</function>
	<!--人员列表 -->
	<function name="list_oa_staff_by_sql" type="sql" sql="select id,oa_org,login_name from oa_staff where 1=1 ${case}1">
		<parser index="1">
			<param fspname="id" sqlname="id"></param>
		</parser>
	</function>
	<function name="list_oa_timebase_by_sql" type="sql" sql="select * from oa_timebase where 1=1 ${case}1">
		<parser index="1">
			<param fspname="define_key" sqlname="define_key"></param>
			<param fspname="cloth_class" sqlname="cloth_class"></param>
		</parser>
	</function>
	<!--时间基准查询 -->
	<function name="list_oa_timebase_entry_by_sql" type="sql" sql="select ot.define_key,ot.cloth_class,ote.step,ote.step_duration,ote.calculate_duration from oa_timebase ot, oa_timebase_entry ote where 
ote.oa_timebase = ot.id ${case}1">
		<parser index="1">
			<param fspname="id" sqlname="id"></param>
		</parser>
	</function>
	<!-- 处理订单 -->
	<function name="get_oa_order" type="eql" sql="select v from OaOrder v where 1=1 ${case}1">
		<parser index="1">
			<param fspname="oaOrder" sqlname="oaOrder"></param>
		</parser>
	</function>
	<!--数据字典查询 -->
	<function name="list_oa_dt_by_sql" type="sql" sql="select * from oa_dt where 1=1 ${case}1">
		<parser index="1">
			<param fspname="id" sqlname="id"></param>
		</parser>
	</function>
    <!--数据字典查询for code －－范蠡 -->
    <function name="list_oa_dt_by_code_sql" type="sql" sql="select * from oa_dt where 1=1 ${case}1">
        <parser index="1">
            <param fspname="code" sqlname="code"></param>
        </parser>
    </function>
	<function name="list_oa_dt_entry_by_eql" type="eql" sql="select v from OaDt v where 1=1 ${case}1">
		<parser index="1">
			<param fspname="type" sqlname="type"></param>
		</parser>
	</function>
	<function name="get_max_inx_oa_dt_by_sql" type="sql" sql="select max(inx) maxinx from oa_dt where 1=1 ${case}1">
		<parser index="1">
			<param fspname="type" sqlname="type"></param>
		</parser>
	</function>

	<!-- 查询 历史订单 -->
	<function name="list_orderwf_his_by_sql" type="sql" sql="select mian.*, del_oa_order, del_wf_step, del_operator,
																	cqdel_oa_order, cqdel_wf_step, cqdel_operator,
																	jsdel_oa_order, jsdel_wf_step, jsdel_operator,
																	jshdel_oa_order, jshdel_wf_step, jshdel_operator,
																	cqcdel_oa_order, cqcdel_wf_step, cqcdel_operator,
																	mr_oa_order, mr_if_repeat, mr_if_qualified,
																	wldel_oa_order, wldel_wf_step, wldel_wf_plan_start, wldel_wf_step_duration, wldel_wf_real_finish,
																	mrdel_oa_order, mrdel_wf_step, mrdel_wf_real_start, mrdel_operator,
																	mrdb_oa_order, mrdb_wf_step, mrdb_wf_real_start, mrdb_operator,
																	odel_wf_step, odel_operator, odel_oa_order,
																	fidel_oa_order, fidel_wf_step, fidel_wf_real_start, fidel_operator,
																	tpedel_oa_order, tpedel_wf_step, tpedel_wf_real_start, tpedel_operator,
																	bqcdel_oa_order, bqcdel_wf_step, bqcdel_wf_plan_start, bqcdel_wf_real_finish, bqcdel_wf_step_duration, bqcdel_operator
																from
																(
																SELECT
																	oa.*,
																	tpe.sewing_factory,
																	tpe.sewing_num,
																	tpe.sewing_total,
																	qa.qualified_num_info,
																	qa.unqualified_num_info,
																	qa.qualified_total,
																	qa.unqualified_total,
																	cost.p_sam,
																	qadel_oa_order,
																	qadel_wf_step,
																	qadel_operator,
																	qadel_wf_real_finish
																FROM
																	oa_order oa
																LEFT JOIN oa_tpe tpe
																	on oa.id = tpe.oa_order_id
																LEFT JOIN oa_qa qa
																	on oa.id = qa.oa_order_id
                                                                LEFT JOIN oa_cost cost
                                                                    ON oa.id = cost.oa_order_id
																LEFT JOIN (select oa_order as qadel_oa_order, wf_step as qadel_wf_step, operator as qadel_operator, wf_real_finish as qadel_wf_real_finish from oa_order_detail where wf_step = 'c_ppc_confirm_7' order by id desc) qadel
																	on oa.id = qadel.qadel_oa_order

																) mian
																LEFT JOIN (select oa_order as del_oa_order, wf_step as del_wf_step, operator as del_operator  from oa_order_detail where 1=1 and (wf_step = 'c_ppc_assign_3' or wf_step = 'b_ppc_confirm_3')) deatile
																	on mian.id = del_oa_order
																LEFT JOIN (select oa_order as cqdel_oa_order, wf_step as cqdel_wf_step, operator as cqdel_operator  from oa_order_detail where 1=1 and wf_step = 'b_ppc_confirm_5' order by id desc) cqdel
																	on mian.id = cqdel_oa_order
                                                                LEFT JOIN (select oa_order as jsdel_oa_order, wf_step as jsdel_wf_step, operator as jsdel_operator  from oa_order_detail where 1=1 and wf_step = 'b_pur_confirm_4' order by id desc) jsdel
																	on mian.id = jsdel_oa_order
                                                                LEFT JOIN (select oa_order as jshdel_oa_order, wf_step as jshdel_wf_step, operator as jshdel_operator  from oa_order_detail where 1=1 and wf_step = 'c_ppc_assign_3' order by id desc) jshdel
																	on mian.id = jshdel_oa_order
																LEFT JOIN (select oa_order as cqcdel_oa_order, wf_step as cqcdel_wf_step, operator as cqcdel_operator  from oa_order_detail where 1=1 and wf_step = 'c_ppc_factoryMsg_5' order by id desc) cqcdel
																	on mian.id = cqcdel_oa_order
																LEFT JOIN (select oa_order as mr_oa_order, if_repeat as mr_if_repeat, if_qualified as mr_if_qualified  from oa_mr_confirm) mr
																	on mian.id = mr_oa_order
																LEFT JOIN (select oa_order as wldel_oa_order, wf_step as wldel_wf_step, wf_plan_start as wldel_wf_plan_start, wf_real_finish as wldel_wf_real_finish, wf_step_duration as wldel_wf_step_duration  from oa_order_detail where 1=1 and wf_step = 'c_ppc_confirm_9' order by id desc) wldel
																	on mian.id = wldel_oa_order
																LEFT JOIN (select oa_order as mrdel_oa_order, wf_step as mrdel_wf_step, wf_real_start as mrdel_wf_real_start, operator as mrdel_operator from oa_order_detail where 1=1 and wf_step = 'c_mr_improve_2' order by id desc) mrdel
																	on mian.id = mrdel_oa_order
                                                                LEFT JOIN( select oa_order AS mrdb_oa_order, wf_step AS mrdb_wf_step, wf_real_start AS mrdb_wf_real_start, operator AS mrdb_operator from oa_order_detail where 1 = 1 and wf_step = 'b_mr_improve_2' order by id desc) mrdb
	                                                                ON mian.id = mrdb_oa_order
	                                                            LEFT JOIN(
																	SELECT
																		wf_step AS odel_wf_step, operator AS odel_operator, oa_order AS odel_oa_order
																	FROM
																		oa_order_detail
																	WHERE
																		1 = 1
																	AND(
																		wf_step = 'c_mr_improve_2'
																		OR wf_step = 'b_mr_improve_2'
																	) and ISNULL(back_flag)
																)odel ON mian.id = odel_oa_order
																LEFT JOIN (select oa_order as fidel_oa_order, wf_step as fidel_wf_step, wf_real_start as fidel_wf_real_start, operator as fidel_operator from oa_order_detail where 1=1 and (wf_step = 'c_fi_pay_4' or wf_step = 'b_ppc_confirm_3')) fidel
																	on mian.id = fidel_oa_order
																LEFT JOIN (select oa_order as tpedel_oa_order, wf_step as tpedel_wf_step, wf_real_start as tpedel_wf_real_start, operator as tpedel_operator from oa_order_detail where 1=1 and wf_step = 'c_qc_cutting_6' order by id desc) tpedel
																	on mian.id = tpedel_oa_order
																LEFT JOIN(SELECT oa_order AS bqcdel_oa_order, wf_step AS bqcdel_wf_step, wf_plan_start as bqcdel_wf_plan_start, wf_real_finish AS bqcdel_wf_real_finish, wf_step_duration as bqcdel_wf_step_duration, operator AS bqcdel_operator FROM oa_order_detail WHERE 1 = 1 AND wf_step = 'b_qc_confirm_6' order by id desc) bqcdel
	                                                                ON mian.id = bqcdel_oa_order
																where 1 = 1  ${case}1  GROUP BY mian.id  ORDER BY mian.end_time desc">
		<parser index="1">
            <param fspname="his_opt" sqlname="mian.his_opt" op="like"></param>
			<param fspname="cus_name" sqlname="mian.cus_name"  op="like"></param>
			<param fspname="style_code" sqlname="mian.style_code" op="like"></param>
			<param fspname="sell_order_code" sqlname="mian.sell_order_code" op="like"></param>
			<param fspname="type" sqlname="mian.type"></param>
			<param fspname="city" sqlname="mian.city"></param>
			<param fspname="order_code" sqlname="mian.order_code" op="like"></param>
			<param fspname="sales" sqlname="mian.sales"></param>
			<param fspname="mr_name" sqlname="odel_operator"></param>
			<param fspname="tpe_name" sqlname="tpedel_operator"></param>
			<param fspname="sewing_factory" sqlname="mian.sewing_factory"></param>
			<param fspname="status" sqlname="mian.status"></param>
			<param fspname="wf_step" sqlname="mian.wf_step"></param>
			<param fspname="if_all" sqlname=" and (wf_step=? or status='1') " op="sp"></param>
			<param fspname="start_time1" sqlname="mian.begin_time" op="&gt;="></param>
			<param fspname="start_time2" sqlname="mian.begin_time" op="&lt;"></param>
			<param fspname="qadel_wf_real_finish1" sqlname="mian.qadel_wf_real_finish" op="&gt;="></param>
			<param fspname="qadel_wf_real_finish2" sqlname="mian.qadel_wf_real_finish" op="&lt;"></param>
			<param fspname="wldel_wf_real_finish1" sqlname="wldel_wf_real_finish" op="&gt;="></param>
			<param fspname="wldel_wf_real_finish2" sqlname="wldel_wf_real_finish" op="&lt;"></param>
			<param fspname="del_operator" sqlname="del_operator" ></param>
			<param fspname="cqdel_operator" sqlname="cqdel_operator"></param>
			<param fspname="cqcdel_operator" sqlname="cqcdel_operator"></param>
			<param fspname="qadel_operator" sqlname="mian.qadel_operator"></param>
			<param fspname="if_qualified" sqlname="mr_if_qualified"></param>
			<param fspname="if_repeat" sqlname="mr_if_repeat"></param>
		</parser>
	</function>


    <!-- 查询 历史订单 -->
    <function name="list_orderwf_his_yh_by_sql" type="sql" sql="select * from oa_order mian
																where 1 = 1  ${case}1  GROUP BY mian.id  ORDER BY mian.end_time desc">
        <parser index="1">
            <param fspname="his_opt" sqlname="mian.his_opt" op="like"></param>
            <param fspname="cus_name" sqlname="mian.cus_name"></param>
            <param fspname="style_code" sqlname="mian.style_code" op="like"></param>
            <param fspname="sell_order_code" sqlname="mian.sell_order_code" op="like"></param>
            <param fspname="type" sqlname="mian.type"></param>
            <param fspname="city" sqlname="mian.city"></param>
            <param fspname="order_code" sqlname="mian.order_code" op="like"></param>
            <param fspname="sales" sqlname="mian.sales"></param>
            <param fspname="wf_step" sqlname="mian.wf_step"></param>
            <param fspname="if_all" sqlname=" and (wf_step=? or status='1') " op="sp"></param>
            <param fspname="start_time1" sqlname="mian.begin_time" op="&gt;="></param>
            <param fspname="start_time2" sqlname="mian.begin_time" op="&lt;"></param>
        </parser>
    </function>
    <!-- 查询 历史订单2 -->
    <function name="list_order_his_detail_by_sql" type="sql" sql="SELECT
                                                                    oo.id,
                                                                    oo.type,
                                                                    oo.style_code,
                                                                    oo.style_desc,
                                                                    oo.wf_step_name,
                                                                    oo.mr_name,
                                                                    oq.qualified_total,
                                                                    oq.unqualified_total,
                                                                    ot.sewing_total,
                                                                    ood.worker,
                                                                    ot.sewing_factory,
                                                                    ood.operator,
                                                                    oo.sell_order_code,
                                                                    oo.cus_name,
                                                                    oo.cloth_class,
                                                                    oo.style_class,
                                                                    ood.wf_step,
                                                                    ood.wf_step_duration,
                                                                    ood.wf_real_start,
                                                                    ood.wf_real_finish,
                                                                    oo.begin_time,
                                                                    oo.except_finish,
                                                                    mr.if_repeat,
                                                                    mr.if_qualified
                                                                FROM
                                                                    oa_order AS oo
                                                                LEFT JOIN oa_order_detail AS ood ON ood.oa_order = oo.id
                                                                LEFT JOIN oa_tpe AS ot ON ot.oa_order_id = oo.id
                                                                LEFT JOIN oa_qa AS oq ON oq.oa_order_id = oo.id
                                                                LEFT JOIN oa_mr_confirm AS mr on mr.oa_order = oo.id
																where 1 = 1  ${case}1">
        <parser index="1">
            <param fspname="id" sqlname="oo.id"></param>
            <param fspname="sewing_factory" sqlname="ot.sewing_factory"></param>
            <param fspname="if_qualified" sqlname="mr.if_qualified"></param>
            <param fspname="if_repeat" sqlname="mr.if_repeat"></param>

        </parser>
    </function>



	<!--时间基准查询 -->
	<function name="list_oa_timebase_by_eql" type="eql" sql="select v from OaTimebase v where 1=1 ${case}1">
		<parser index="1">
			<param fspname="id" sqlname="id"></param>
		</parser>
	</function>
	<function name="list_oa_timebase_entry_by_eql" type="eql" sql="select v from OaTimebaseEntry v where 1=1 ${case}1">
		<parser index="1">
			<param fspname="oaTimebase" sqlname="oaTimebase"></param>
		</parser>
	</function>
	<!-- 订单详细查询 -->
	<function name="list_oa_order_detail_by_sql" type="sql" sql="select * from oa_order_detail where 1=1 ${case}1">
		<parser index="1">
			<param fspname="oa_order" sqlname="oa_order"></param>
		</parser>
	</function>
	<!-- 新增订单中的带回 -->
	<function name="list_oa_assorder_by_sql" type="sql" sql="select order_code from oa_order where 1=1 ${case}1">
		<parser index="1">
			<param fspname="order_code" sqlname="order_code"></param>
		</parser>
	</function>
	<function name="list_oa_sales_by_sql" type="sql" sql="select login_name from oa_staff where oa_org=10">
		<parser index="1">
			<param fspname="login_name" sqlname="login_name"></param>
		</parser>
	</function>
	<!-- 根据登录名查询分组信息 -->
	<function name="get_oa_org_by_sql" type="sql" sql="select * from oa_org where id = (select oa_org from oa_staff where 1=1 ${case}1)">
		<parser index="1">
			<param fspname="login_name" sqlname="login_name"></param>
		</parser>
	</function>
	<function name="get_oa_staff_pwd" type="sql" sql="select login_name,password where 1=1 ${case}1">
		<parser index="1">
			<param fspname="login_name" sqlname="login_name"></param>

		</parser>
	</function>
	<!-- 获取15分钟内未处理的任务 -->
	<function name="get_oa_order_detail_by_sql" type="sql" sql="select * from oa_order_detail where 1=1 ${case}1 ">
		<parser index="1">
			<param fspname="staff_name" sqlname="operator"></param>
			<param fspname="finish_time" sqlname="wf_real_finish"></param>
		</parser>
	</function>
	<function name="get_oa_order_detail_for_mail" type="sql" sql="select oo.style_code,ood.wf_step_name,ood.operator,ood.wf_real_start,ood.wf_step_duration from oa_order oo,oa_order_detail ood where oo.id=(select oa_order from oa_order_detail where 1=1 ${case}1) and oo.oa_order_detail=ood.id">
		<parser index="1">
			<param fspname="id" sqlname="id"></param>
		</parser>
	</function>

	<!-- 样衣打版订单时间控制表 -->
	<function name="list_oa_order_dbtc_by_sql" type="sql" sql="select style_code,begin_time,wf_real_start,end_time from oa_order where wf_step!='finish_999' and status='0' and type = '2' ${case}1 ">
		<parser index="1">
			<param fspname="orderId" sqlname="id"></param>
			<param fspname="begin_time" sqlname="end_time" op="&gt;="></param>
			<param fspname="end_time" sqlname="end_time" op="&lt;"></param>
		</parser>
	</function>
	<!-- 大货订单时间控制表 -->
	<function name="list_oa_order_dhtc_by_sql" type="sql" sql="select style_code,begin_time,wf_real_start,end_time from oa_order where wf_step!='finish_999' and status='0' and type = '3' ${case}1 ">
		<parser index="1">
			<param fspname="orderId" sqlname="id"></param>
			<param fspname="begin_time" sqlname="end_time" op="&gt;="></param>
			<param fspname="end_time" sqlname="end_time" op="&lt;"></param>
		</parser>
	</function>

	<!-- 大货订单时间控制表 常遇春 -->
	<function name="list_oa_order_dhtc_by_sql2" type="sql" sql="select style_code,begin_time,wf_real_start,end_time from oa_order where wf_step='finish_999' and status='0' and type = '3' ${case}1 ">
		<parser index="1">
			<param fspname="orderId" sqlname="id"></param>
			<param fspname="begin_time" sqlname="end_time" op="&gt;="></param>
			<param fspname="end_time" sqlname="end_time" op="&lt;"></param>
		</parser>
	</function>

	<function name="list_oa_order_detail_fi_dhtc_by_sql" type="sql" sql="select count(id) times, max(wf_real_finish) wf_real_finish,min(wf_real_finish) f_finish,max(wf_real_start) l_start,min(wf_real_start) f_start,oa_order,wf_step_duration from oa_order_detail where wf_step='c_fi_confirm_2' and oa_order in (select id from oa_order where wf_step='finish_999' and status='0' and type ='3' ${case}1 ) ">
		<parser index="1">
			<param fspname="order_id" sqlname="id"></param>
			<param fspname="begin_time" sqlname="end_time" op="&gt;="></param>
			<param fspname="end_time" sqlname="end_time" op="&lt;"></param>
		</parser>
	</function>

	<function name="list_oa_order_detail_it_dhtc_by_sql" type="sql" sql="select count(id) times, max(wf_real_finish) wf_real_finish,min(wf_real_finish) f_finish,max(wf_real_start) l_start,min(wf_real_start) f_start,oa_order,wf_step_duration from oa_order_detail where wf_step='c_ppc_assign_3' and oa_order in (select id from oa_order where wf_step='finish_999' and status='0' and type ='3' ${case}1 ) ">
		<parser index="1">
			<param fspname="order_id" sqlname="id"></param>
			<param fspname="begin_time" sqlname="end_time" op="&gt;="></param>
			<param fspname="end_time" sqlname="end_time" op="&lt;"></param>
		</parser>
	</function>

	<function name="list_oa_order_detail_pur_dhtc_by_sql" type="sql" sql="select count(id) times, max(wf_real_finish) wf_real_finish,min(wf_real_finish) f_finish,max(wf_real_start) l_start,min(wf_real_start) f_start,oa_order,wf_step_duration from oa_order_detail where wf_step='c_fi_pay_4' and oa_order in (select id from oa_order where wf_step='finish_999' and status='0' and type ='3' ${case}1 ) ">
		<parser index="1">
			<param fspname="order_id" sqlname="id"></param>
			<param fspname="begin_time" sqlname="end_time" op="&gt;="></param>
			<param fspname="end_time" sqlname="end_time" op="&lt;"></param>
		</parser>
	</function>

	<function name="list_oa_order_detail_cqc_dhtc_by_sql" type="sql" sql="select count(id) times,max(wf_real_finish) wf_real_finish,min(wf_real_finish) f_finish,max(wf_real_start) l_start,min(wf_real_start) f_start,oa_order,wf_step_duration from oa_order_detail where wf_step='c_ppc_factoryMsg_5' and oa_order in (select id from oa_order where wf_step='finish_999' and status='0' and type ='3' ${case}1 ) ">
		<parser index="1">
			<param fspname="order_id" sqlname="id"></param>
			<param fspname="begin_time" sqlname="end_time" op="&gt;="></param>
			<param fspname="end_time" sqlname="end_time" op="&lt;"></param>
		</parser>
	</function>

	<function name="list_oa_order_detail_qc_dhtc_by_sql" type="sql" sql="select count(id) times, max(wf_real_finish) wf_real_finish,min(wf_real_finish) f_finish,max(wf_real_start) l_start,min(wf_real_start) f_start,oa_order,wf_step_duration from oa_order_detail where wf_step='c_qc_cutting_6' and oa_order in (select id from oa_order where wf_step='finish_999' and status='0' and type ='3' ${case}1 ) ">
		<parser index="1">
			<param fspname="order_id" sqlname="id"></param>
			<param fspname="begin_time" sqlname="end_time" op="&gt;="></param>
			<param fspname="end_time" sqlname="end_time" op="&lt;"></param>
		</parser>
	</function>

	<function name="list_oa_order_detail_qa_dhtc_by_sql" type="sql" sql="select count(id) times, max(wf_real_finish) wf_real_finish,min(wf_real_finish) f_finish,max(wf_real_start) l_start,min(wf_real_start) f_start,oa_order,wf_step_duration from oa_order_detail where wf_step='c_ppc_confirm_7' and oa_order in (select id from oa_order where wf_step='finish_999' and status='0' and type ='3' ${case}1 ) ">
		<parser index="1">
			<param fspname="order_id" sqlname="id"></param>
			<param fspname="begin_time" sqlname="end_time" op="&gt;="></param>
			<param fspname="end_time" sqlname="end_time" op="&lt;"></param>
		</parser>
	</function>

	<function name="list_oa_order_detail_fi2_dhtc_by_sql" type="sql" sql="select count(id) times, max(wf_real_finish) wf_real_finish,min(wf_real_finish) f_finish,max(wf_real_start) l_start,min(wf_real_start) f_start,oa_order,wf_step_duration from oa_order_detail where wf_step='c_qc_printing_8' and oa_order in (select id from oa_order where wf_step='finish_999' and status='0' and type ='3' ${case}1 ) ">
		<parser index="1">
			<param fspname="order_id" sqlname="id"></param>
			<param fspname="begin_time" sqlname="end_time" op="&gt;="></param>
			<param fspname="end_time" sqlname="end_time" op="&lt;"></param>
		</parser>
	</function>

	<function name="list_oa_order_detail_qa2_dhtc_by_sql" type="sql" sql="select count(id) times, max(wf_real_finish) wf_real_finish,min(wf_real_finish) f_finish,max(wf_real_start) l_start,min(wf_real_start) f_start,oa_order,wf_step_duration from oa_order_detail where wf_step='c_ppc_confirm_9' and oa_order in (select id from oa_order where wf_step='finish_999' and status='0' and type ='3' ${case}1 ) ">
		<parser index="1">
			<param fspname="order_id" sqlname="id"></param>
			<param fspname="begin_time" sqlname="end_time" op="&gt;="></param>
			<param fspname="end_time" sqlname="end_time" op="&lt;"></param>
		</parser>
	</function>

	<function name="list_oa_order_detail_all_dhtc_by_sql" type="sql" sql="select wf_step_duration,wf_real_start f_start,wf_real_finish f_finish from oa_order_detail where 1=1 ${case}1 ">
		<parser index="1">
			<param fspname="order_id" sqlname="oa_order"></param>
			<param fspname="step" sqlname="wf_step"></param>
		</parser>
	</function>

	<!-- 部门时间计算表 -->
	<function name="list_oa_order_departmenttime_by_sql_fs" type="sql" sql="select count(ood.id) times,oo.style_code,max(ood.wf_real_finish) wf_real_finish,min(ood.wf_real_finish) f_finish,max(ood.wf_real_start) l_start,min(ood.wf_real_start) f_start,ood.wf_step_duration,ood.oa_order,ood.operator 
			from oa_order_detail ood,oa_order oo 
			where  oo.id = ood.oa_order ${case}2 and ood.oa_order in (select o.id from oa_order o where o.wf_step='finish_999' and o.status='0' ${case}1 ) group by ood.oa_order  ">
		<parser index="1">
			<param fspname="orderId" sqlname="o.id"></param>
			<param fspname="begin_time" sqlname="o.begin_time" op="&gt;="></param>
			<param fspname="end_time" sqlname="o.begin_time" op="&lt;"></param>
		</parser>
		<parser index="2">
			<param fspname="step" sqlname="ood.wf_step"></param>
			<param fspname="operator" sqlname="ood.operator"></param>
		</parser>
	</function>

	<!-- 部门时间计算表 -->
	<function name="list_oa_order_departmenttime_by_sql" type="sql" sql="select count(ood.id) times,oo.style_code,max(ood.wf_real_finish) wf_real_finish,min(ood.wf_real_finish) f_finish,max(ood.wf_real_start) l_start,min(ood.wf_real_start) f_start,ood.wf_step_duration,ood.oa_order,ood.operator,ood.content 
			from oa_order_detail ood,oa_order oo 
			where  oo.id = ood.oa_order ${case}1 group by ood.oa_order ">
		<parser index="1">
			<param fspname="begin_time" sqlname="ood.wf_real_start" op="&gt;="></param>
			<param fspname="end_time" sqlname="ood.wf_real_start" op="&lt;"></param>
			<param fspname="step" sqlname="ood.wf_step"></param>
			<param fspname="operator" sqlname="ood.operator"></param>
		</parser>
	</function>


	<!-- 通过款号查找订单 -->
	<function name="get_order_from_style_code_by_sql" type="sql" sql="select * from oa_order where 1=1 ${case}1">
		<parser index="1">
			<param fspname="styleCode" sqlname="style_code"></param>
		</parser>
	</function>

	<!-- 通过订单id查看订单下一流程所需时间 -->
	<function name="get_oa_order_detail_time_for_notify_staff_by_sql" type="sql" sql="select ood.id,ood.oa_order,ood.wf_real_start,ood.operator,ood.wf_step_duration,ood.wf_step,ood.wf_step_name,ood.sms_remind,os.linkphone,oo.style_code,oo.tel,count(ood.wf_step) times,ood.inx,oo.type
				from oa_order_detail ood,oa_order oo,oa_staff os 
				where ood.oa_order=oo.id and ood.operator=os.login_name ${case}1
				group by ood.wf_step ">
		<parser index="1">
			<param fspname="oaOrder" sqlname="ood.oa_order"></param>
		</parser>
	</function>

	<!-- 定时提醒订单剩余时间少于3小时 和超时订单 -->
	<function name="get_oa_order_detail_for_autonotify_by_sql" type="sql" sql="select oo.id,oo.style_code,oo.operator,ood.wf_step,ood.wf_step_name,ood.wf_step_duration,ood.sms_remind ,os.linkphone,ood.id detail_id,ood.wf_real_start,ood.sms_timeout,os.oa_org
				from oa_order oo, (select * from oa_order_detail order by id desc) ood ,oa_staff os 
				where oo.wf_step != 'finish_999' and oo.id = ood.oa_order and oo.status = '0' and ood.operator = os.login_name and sms_timeout = '1' ${case}1 group by ood.oa_order ">
		<parser index="1">
			<param fspname="oaOrder" sqlname="ood.oa_order"></param>
		</parser>
	</function>

	<!-- 查询流程 -->
	<function name="get_oa_order_detail_by_eql" type="eql" sql="select vo from OaOrderDetail vo where 1=1 ${case}1 ">
		<parser index="1">
			<param fspname="id" sqlname="id"></param>
			<param fspname="oaOrder" sqlname="oaOrder"></param>
			<param fspname="inx" sqlname="inx" op="&lt;&gt;"></param>
			<param fspname="wfStep" sqlname="wfStep"></param>
		</parser>
	</function>

	<!-- 获取部门主管手机号 -->
	<function name="get_oa_org_leader_linkphone_by_sql" type="sql" sql="select org.id,org.name,org.admin,os.linkphone from oa_org org,oa_staff os where org.admin = os.login_name ${case}1 ">
		<parser index="1">
			<param fspname="leader" sqlname="org.admin"></param>
		</parser>
	</function>

	<!--订单列表查询 -->
	<!-- update by fangwei 2014.12.03 -->
	<!-- update by 张华 2014-12-30 -->
	<!-- update by 范蠡 2015-01-29
	
	LEFT JOIN(
														SELECT
															name,
															dahuo_cyc,
															daban_cyc
														FROM
															oa_category
													)cg ON oder.style_class = cg.name
	 -->
	<function name="get_order_list" type="sql" sql="SELECT * FROM
														(
															SELECT
																o.sell_order_id, o.sell_order_code, o.oa_order_detail, o.his_opt, o.id,
																o.type, o.style_type, o.style_craft, o.style_class, o.sales, o.style_code,
																o.style_desc, o.style_id, o.cus_id, o.cus_name, o.begin_time, o.want_cnt,
																o.mr_name, o.tpe_name, o.wf_step_name, o.wf_step, o.wf_step_duration,
																o.cloth_class, o.pay_type, o.order_code, o.wf_plan_start, o.wf_real_start,
																o.except_finish, o.city, o.is_urgent, o.operator, o. STATUS,
																o.sell_ready_time, o.standard_time, o.craft_time, o.feeding_time, o.goods_time
															FROM
																oa_order AS o
														)oder
													LEFT JOIN(
														SELECT
															oa_order_id, sewing_num, sewing_total, sewing_factory
														FROM 
														oa_tpe
													)tpe ON oder.id = tpe.oa_order_id
													LEFT JOIN(
														SELECT
															name,
															dahuo_cyc,
															daban_cyc
														FROM
															oa_category
													)cg ON oder.style_class = cg.name
													LEFT JOIN(
														SELECT
															oa_order_id AS cost_oa_order_id, p_sam
														FROM
															oa_cost
													)cost ON oder.id = cost.cost_oa_order_id
													LEFT JOIN(
														SELECT
															value,
															code
														FROM
															oa_dt
													)dt ON oder.cloth_class = dt.code
													LEFT JOIN(
														SELECT
															oa_order_id AS qa_order_id, qualified_num_info, unqualified_num_info,
															qualified_total, unqualified_total
														FROM
															oa_qa
													)qa ON oder.id = qa.qa_order_id
													LEFT JOIN(
														SELECT
															wf_step AS odel_wf_step, operator AS odel_operator, wf_real_start AS odel_wf_real_start, wf_real_finish AS odel_wf_real_finish,
															oa_order AS odel_oa_order
														FROM
															oa_order_detail
														WHERE
															1 = 1
														AND(
															wf_step = 'c_mr_improve_2'
															OR wf_step = 'b_mr_improve_2'
														) and ISNULL(back_flag)
													)odel ON oder.id = odel_oa_order
													LEFT JOIN(
														SELECT
															wf_step AS ppc_wf_step,
															wf_real_start AS ppc_wf_real_start,
															wf_real_finish AS ppc_wf_real_finish,
															oa_order AS ppc_oa_order
														FROM
															oa_order_detail
														WHERE
															1 = 1
														AND wf_step = 'c_ppc_assign_3'
														and ISNULL(back_flag)
													)ppc ON oder.id = ppc_oa_order
													LEFT JOIN (select oa_order as tpedel_oa_order, wf_step as tpedel_wf_step, wf_real_start as tpedel_wf_real_start, operator as tpedel_operator from oa_order_detail where 1=1 and wf_step = 'c_qc_cutting_6' and ISNULL(back_flag)) tpedel
																	on oder.id = tpedel_oa_order 
													LEFT JOIN(
														SELECT
															wf_step AS odelqa_wf_step,
															wf_real_start AS odelqa_wf_real_start,
															wf_real_finish AS odelqa_wf_real_finish,
															oa_order AS odelqa_oa_order
														FROM
															oa_order_detail
														WHERE
															1 = 1
														AND wf_step = 'c_ppc_confirm_7'
														 and ISNULL(back_flag)
													)odelqa ON oder.id = odelqa_oa_order
														where oder.STATUS = '0' and oder.wf_step != 'finish_999' ${case}1 GROUP BY oder.id ">
		<parser index="1">
			<param fspname="sell_order_code" sqlname="oder.sell_order_code" op="like"></param>
			<param fspname="style_type" sqlname="oder.style_type"></param>
			<param fspname="style_craft" sqlname="oder.style_craft" op="like"></param>
			<param fspname="style_code" sqlname="oder.style_code" op="like"></param>
			<param fspname="style_class" sqlname="oder.style_class" op="like"></param>
			<param fspname="his_opt" sqlname="oder.his_opt" op="like"></param>
			<param fspname="cus_name" sqlname="oder.cus_name" op="like"></param>
			<param fspname="sales" sqlname="oder.sales"></param>
			<param fspname="mr_name" sqlname="odel_operator"></param>
			<param fspname="tpe_name" sqlname="tpedel_operator"></param>
			<param fspname="type" sqlname="oder.type"></param>
			<param fspname="city" sqlname="oder.city"></param>
			<param fspname="wf_step" sqlname="oder.wf_step"></param>
			<param fspname="is_urgent" sqlname="oder.is_urgent"></param>
			<param fspname="start_time1" sqlname="oder.begin_time" op="&gt;="></param>
			<param fspname="start_time2" sqlname="oder.begin_time" op="&lt;"></param>
			<param fspname="sewing_factory" sqlname="tpe.sewing_factory"></param>
			<param fspname="odel_wf_step" sqlname="odel_wf_step"></param>
			<param fspname="odelqa_wf_step" sqlname="odelqa_wf_step"></param>
			<param fspname="odel_wf_real_start" sqlname="odel_wf_real_start" op="&gt;="></param>
			<param fspname="odel_wf_real_start1" sqlname="odel_wf_real_start" op="&lt;"></param>
            <param fspname="odel_wf_real_finish" sqlname="odel_wf_real_finish" op="&gt;="></param>
            <param fspname="odel_wf_real_finish1" sqlname="odel_wf_real_finish" op="&lt;"></param>
			<param fspname="odelqa_wf_real_finish" sqlname="odelqa_wf_real_finish" op="&gt;="></param>
			<param fspname="odelqa_wf_real_finish1" sqlname="odelqa_wf_real_finish" op="&lt;"></param>
            <param fspname="ppc_wf_real_finish" sqlname="ppc_wf_real_finish" op="&gt;="></param>
			<param fspname="ppc_wf_real_finish1" sqlname="ppc_wf_real_finish" op="&lt;"></param>
		</parser>
	</function>

	<!--订单详情附件查询 -->
	<!-- update by fangwei 2014.12.15 -->
	<function name="get_detail_excel" type="sql" sql="select id,content,other_file,worker,work_time,attachment,task_id,operator,wf_real_start,wf_real_finish from oa_order_detail where task_id =(select max(CAST(task_id AS SIGNED)) from oa_order_detail where 1=1 ${case}1 ) ${case}2 ">
		<!-- and attachment is not null && LENGTH(trim(attachment))>0 附件非空的判断，当前系统一半最大ID的附件不为空 -->
		<parser index="1">
			<param fspname="wf_step" sqlname="wf_step" op="like"></param>
			<param fspname="oa_order" sqlname="oa_order"></param>
		</parser>
		<parser index="2">
			<param fspname="wf_step" sqlname="wf_step" op="like"></param>
			<param fspname="oa_order" sqlname="oa_order"></param>
		</parser>
	</function>


	<!--订单详情附件查询 -->
	<!-- update by fangwei 2014.12.15 -->
	<function name="get_detail_worker" type="sql" sql="select worker from oa_order_detail where task_id =(select max(CAST(task_id AS SIGNED)) from oa_order_detail where 1=1 ${case}1 ) ${case}2 ">
		<!-- and attachment is not null && LENGTH(trim(attachment))>0 附件非空的判断，当前系统一半最大ID的附件不为空 -->
		<parser index="1">
			<param fspname="wf_step" sqlname="wf_step" op="like"></param>
			<param fspname="oa_order" sqlname="oa_order"></param>
		</parser>
		<parser index="2">
			<param fspname="wf_step" sqlname="wf_step" op="like"></param>
			<param fspname="oa_order" sqlname="oa_order"></param>
		</parser>
	</function>

	<!-- 获取部门待做任务-->
	<function name="list_orgwf_by_sql" type="sql" sql="SELECT oo.id,ood.id oa_order_detail,oo.style_id,oo.goods_time, oo.feeding_time, oo.standard_time, oo.craft_time, oo.sell_ready_time, oo.sell_order_code, oo.type, oo.style_code, oo.style_desc, oo.cus_name, oo.want_cnt, oo.begin_time, oo.style_class, oo.mr_name, oo.wf_step_name, oo.operator,oo.wf_real_start,oo.wf_step_duration 
		FROM oa_order AS oo ,oa_order_detail AS ood,oa_staff AS os
		WHERE oo.wf_step != 'finish_999' AND oo.`status` = '0' 
		AND oo.oa_order_detail = ood.id
		AND os.login_name = oo.operator ${case}1 ">
		<parser index="1">
			<param fspname="org" sqlname="os.oa_org"></param>
			<param fspname="cus_name" sqlname="oo.cus_name" op="like"></param>
			<param fspname="style_code" sqlname="oo.style_code" op="like"></param>
			<param fspname="sell_order_code" sqlname="oo.sell_order_code" op="like"></param>
			<param fspname="type" sqlname="oo.type"></param>
		</parser>
	</function>

	<!-- 查询 order 和 工作流表 -->
	<function name="list_orderwf_by_sql" type="sql" sql="select oo.id,ood.id oa_order_detail,oo.sell_order_code,oo.type,oo.is_urgent,oo.style_id,oo.goods_time, oo.feeding_time, oo.standard_time, oo.craft_time, oo.sell_ready_time,oo.style_code,oo.style_desc,oo.cus_id,oo.cus_code,oo.cus_name,oo.want_cnt,oo.begin_time,oo.mr_name,oo.wf_step_name,oo.wf_real_start,oo.wf_plan_start,oo.wf_step_duration,oo.except_finish,oo.city,oo.operator,oo.wf_step 
			from oa_order oo ,oa_order_detail ood
			where oo.id = ood.oa_order
			  and oo.oa_order_detail = ood.id 
			  and oo.wf_step != 'finish_999' and oo.status = '0' ${case}1">
		<parser index="1">
			<param fspname="operator" sqlname="oo.operator"></param>
			<param fspname="cus_code" sqlname="oo.cus_code" op="like"></param>
			<param fspname="style_code" sqlname="oo.style_code" op="like"></param>
			<param fspname="sell_order_code" sqlname="oo.sell_order_code" op="like"></param>
			<param fspname="is_urgent" sqlname="oo.is_urgent"></param>
			<param fspname="ppc" sqlname="oo.ppc"></param>
			<param fspname="sales" sqlname="oo.sales"></param>
			<param fspname="type" sqlname="oo.type"></param>
			<param fspname="his_opt" sqlname="oo.his_opt" op="like"></param>
			<param fspname="if_timeout" sqlname=" and NOW() > DATE_ADD(oo.wf_plan_start,INTERVAL oo.wf_step_duration/1000 SECOND) and !isnull(?) " op="sp"></param>
		</parser>
	</function>
	<!-- 查询物料搭配明细 -->
	<function name="get_material_list_by_eql" type="eql" sql="select vo from OaMaterialList vo where 1=1 ${case}1 ">
		<parser index="1">
			<param fspname="oaOrderId" sqlname="oaOrderId"></param>
		</parser>
	</function>
	<!-- 查询客供料明细 -->
	<function name="get_cus_material_list_by_eql" type="eql" sql="select vo from OaCusMaterialList vo where 1=1 ${case}1 ">
		<parser index="1">
			<param fspname="oaOrderId" sqlname="oaOrderId"></param>
		</parser>
	</function>
	<!-- 查询 oa_order的材料清单 -->
	<function name="get_oa_material_list" type="sql" sql="select * from oa_material_list where 1=1 ${case}1">
		<parser index="1">
			<param fspname="oa_order_id" sqlname="oa_order_id"></param>
		</parser>
	</function>
	<!-- 查询 oa_order的客供料明细 -->
	<function name="get_oa_cus_material_list" type="sql" sql="select * from oa_cus_material_list where 1=1 ${case}1">
		<parser index="1">
			<param fspname="oa_order_id" sqlname="oa_order_id"></param>
		</parser>
	</function>
	<!--查询尺码表表头 -->
	<function name="list_clothes_size_by_eql" type="eql" sql="select vo from OaClothesSize vo where 1=1 ${case}1">
		<parser index="1">
			<param fspname="orderId" sqlname="oaOrderId"></param>
		</parser>
	</function>
	<!--查询尺码表内容的表头 -->
	<function name="get_order_num_title_by_eql" type="eql" sql="select vo from OaOrderNum vo where 1=1 ${case}1">
		<parser index="1">
			<param fspname="orderNumId" sqlname="id"></param>
		</parser>
	</function>
	<!--查询尺寸详细内容 -->
	<function name="get_clothes_size_detail_by_sql" type="sql" sql="select * from oa_clothes_size_detail vo where 1=1 ${case}1">
		<parser index="1">
			<param fspname="orderId" sqlname="oa_order"></param>
		</parser>
	</function>
	<!--查询加工说明 -->
	<function name="get_process_explain_by_eql" type="eql" sql="select vo from OaProcessExplain vo where 1=1 ${case}1">
		<parser index="1">
			<param fspname="orderId" sqlname="oaOrderId"></param>
		</parser>
	</function>
	<!--查询异动跟踪信息 -->
	<function name="get_tracke_by_eql" type="eql" sql="select vo from OaTracke vo where 1=1 ${case}1">
		<parser index="1">
			<param fspname="orderId" sqlname="oaOrder"></param>
			<param fspname="node" sqlname="node" op="like"></param>
		</parser>
	</function>
	<!--查询打版的用料说明清单 -->
	<function name="list_da_ban_info_by_sql" type="sql" sql="select ml.id materiallistid,ml.material_prop,ml.material_name,ml.type,ml.color,dbi.id,IFNULL(dbi.buffon,'') as buffon,IFNULL(dbi.unit_num,'') as unit_num,IFNULL(dbi.position,'') as position,ifnull(dbi.it_memo,'') as it_memo 
		from oa_material_list ml left join oa_da_ban_info dbi on dbi.oa_material_list=ml.id where 1=1  ${case}1">
		<parser index="1">
			<param fspname="orderId" sqlname="oa_order_id"></param>
		</parser>
	</function>
	<!--查询大货的用料说明清单 -->
	<function name="list_da_huo_info_by_sql" type="sql" sql="select ml.id materiallistid,ml.material_prop,ml.material_name,ml.type,ml.color,dbi.id,IFNULL(dbi.buffon,'') as buffon,IFNULL(dbi.unit_num,'') as unit_num,IFNULL(dbi.position,'') as position,
		IFNULL(dbi.it_memo,'') as it_memo from oa_material_list ml left join oa_da_huo_info dbi on dbi.oa_material_list=ml.id  where 1=1 ${case}1">
		<parser index="1">
			<param fspname="orderId" sqlname="oa_order_id"></param>
		</parser>
	</function>
	<!--面辅料采购清单打版 -->
	<function name="get_da_ban_material_purchase_desc_by_sql" type="sql" sql="select ml.id materialListId,ml.position,ml.oa_order_id,material_prop,type,material_name,color,supplier_name,supplier_addr,supplier_tel,dbi.id daBanId,IFNULL(weight,0) as weight,
       component,IFNULL(delivery_time,'') as delivery_time,IFNULL(buyer_loss,0) as buyer_loss,IFNULL(paper_tube,0) as paper_tube,IFNULL(deviation,0) as deviation,
			IFNULL(shear_price,0) as shear_price,unit,IFNULL(goods_price,0) as goods_price,goods_unit,IFNULL(buffon,0) as buffon,IFNULL(pur_memo,'') as pur_memo  
       from oa_material_list ml left join oa_da_ban_info dbi on dbi.oa_material_list=ml.id where 1=1  ${case}1">
		<parser index="1">
			<param fspname="orderId" sqlname="oa_order_id"></param>
		</parser>
	</function>
	<!--面辅料采购清单大货 -->
	<function name="get_da_huo_material_purchase_desc_by_sql" type="sql" sql="select ml.id as materialListId ,IFNULL(ml.position,'') as position,ml.oa_order_id,IFNULL(material_prop,'') as material_prop,type,IFNULL(material_name,'') as material_name,IFNULL(color,'') as color,
	IFNULL(supplier_name,'') as supplier_name,IFNULL(supplier_addr,'') as supplier_addr,IFNULL(supplier_tel,'') as supplier_tel,dbi.id as daHuoId,IFNULL(buffon,0) as buffon,IFNULL(unit_num,0) as unit_num,
	IFNULL(ml.order_num,0) as order_num,IFNULL(need_num,0) as need_num,IFNULL(org,'') as org,IFNULL(num,0) as num,IFNULL(price,0) as price,IFNULL(total_price,0) as total_price,IFNULL(test_price,0) as test_price,
	IFNULL(freight,0) as freight,IFNULL(total,0) as total,IFNULL(buyer_loss,0) as buyer_loss,IFNULL(paper_tube,0) as paper_tube,IFNULL(deviation,0) as deviation,IFNULL(pur_memo,'') as pur_memo 
	from oa_material_list ml left join oa_da_huo_info dbi on dbi.oa_material_list=ml.id  where 1=1 ${case}1">
		<parser index="1">
			<param fspname="orderId" sqlname="oa_order_id"></param>
		</parser>
	</function>
	<!--查询关联订单 -->
	<function name="list_relation_order_by_sql" type="sql" sql="select id,sell_order_code,style_code,style_desc,cus_name,sales,type,oa_order_num_id from oa_order where right(wf_step,1)>2 ${case}1  ">
		<parser index="1">
			<param fspname="codeOrName" sqlname=" concat(cus_code,' ',cus_name)" op="like"></param>
			<param fspname="style_code" sqlname="style_code" op="like"></param>
			<param fspname="type" sqlname="type"></param>
			<param fspname="sales" sqlname="sales"></param>
			<param fspname="mr_name" sqlname="mr_name"></param>
			<param fspname="sell_order_code" sql="sell_order_code" op="like"></param>
		</parser>
	</function>
	<!--查询管理信息内容 -->
	<function name="get_manager_info_by_sql" type="sql" sql="select id, operator,wf_real_start,wf_real_finish,wf_step_duration,content,other_file,wf_step,worker,work_time from oa_order_detail where 1=1 ${case}1 ">
		<parser index="1">
			<param fspname="orderId" sqlname="oa_order"></param>
			<param fspname="node" sqlname="wf_step" op="like"></param>
		</parser>
	</function>
	<!-- 查询物料成本 -->
	<function name="list_material_cost_by_sql" type="sql" sql="select ml.id as ml_id ,ml.material_prop,ml.type,IFNULL(ml.material_name,'') as material_name,IFNULL(ml.color,'') as color,dbi.id as dbi_id,IFNULL(dbi.buffon,0) as buffon,
			IFNULL(dbi.unit_num,0) as unit_num,IFNULL(dbi.cp_price,0) as cp_price,IFNULL(dbi.shear_price,0) as shear_price,IFNULL(dbi.cp_loss,0) as cp_loss,
			IFNULL(dbi.cp_total_price,0) as cp_total_price,IFNULL(dbi.cp_shear_price,0) as cp_shear_price,IFNULL(dbi.cp_memo,'') as cp_memo ,IFNULL(dbi.goods_price,0) as goods_price,
			dbi.goods_unit,IFNULL(dbi.paper_tube,0) as paper_tube,IFNULL(dbi.deviation,0) as deviation,IFNULL(dbi.weight,0) as weight,IFNULL(dbi.buffon,0) as buffon,IFNULL(dbi.buyer_loss,0)
				as buyer_loss from oa_material_list ml left join oa_da_ban_info dbi on dbi.oa_material_list=ml.id where 1=1 ${case}1">
		<parser index="1">
			<param fspname="orderId" sqlname="ml.oa_order_id"></param>
		</parser>
	</function>
	<!--查询外协成本及加工成本比 -->
	<function name="get_cost_by_eql" type="eql" sql="select vo from OaCost vo where 1=1 ${case}1">
		<parser index="1">
			<param fspname="orderId" sqlname="oaOrderId"></param>
		</parser>
	</function>
	<!-- 查询MR确认信息 -->
	<function name="get_mr_confirm_by_eql" type="eql" sql="select vo from OaMrConfirm vo where 1=1 ${case}1">
		<parser index="1">
			<param fspname="orderId" sqlname="oaOrder"></param>
		</parser>
	</function>
	<!--获取物料申购 -->
	<function name="get_materials_buy" type="sql" sql="select
			  		oao.id oao_id,
  					oaml.id oaml_id,
					oao.begin_time oao_begin_time,
					oao.sell_order_code oao_sell_order_code,
					oao.mr_name oao_mr_name,
					GROUP_CONCAT(oaml.material_name) oaml_material_name,
					oaml.type oaml_type,
					oaml.color oaml_color,
					oaml.supplier_name oaml_supplier_name,
					oaml.supplier_addr oaml_supplier_addr,
					oaml.supplier_tel oaml_supplier_tel
				from
				oa_order oao , oa_material_list oaml
				where oao.id = oaml.oa_order_id
				${case}1">
		<parser index="1">
			<param fspname="orderId" sqlname="oao.id"></param>
		</parser>
	</function>
	<!--获取物料申购2 -->
	<function name="get_materials_buy2" type="sql" sql="select
			  			odhi.order_num odhi_order_num,
			  			odhi.need_num odhi_need_num,
			  			odhi.unit_num odhi_unit_num
			  		from
			  		oa_da_huo_info odhi,  oa_material_list oaml
			  		where odhi.oa_material_list = odhi.id
					${case}1">
		<parser index="1">
			<param fspname="orderId" sqlname="oaml.oa_order_id"></param>
		</parser>
	</function>

	<!--查询CQC数据 -->
	<function name="get_cqc_by_sql" type="sql" sql="SELECT
													id, oa_material_list,
													apply_unit_num, receive_time,
													receive_num, receive_rate,
													receive_memo, loss_bundles,
													loss_other, loss_oddments,
													loss_memo, shear_num_info,
													loss_company, loss_yiyou
													FROM
													oa_cqc
													 where 1=1 ${case}1 ">
		<parser index="1">
			<param fspname="oaOrderId" sqlname="oa_material_list"></param>
		</parser>
	</function>

	<!--查询QITAO数据 -->
	<function name="get_qitao_by_sql" type="sql" sql="SELECT
														id,
														oa_order_id,
														qitao_receive_time,
														qitao_send_time
														FROM
														oa_qi_tao where 1=1 ${case}1 ">
		<parser index="1">
			<param fspname="oaOrderId" sqlname="oa_order_id"></param>
		</parser>
	</function>

	<!--查询OaQiTaoDetail数据 -->
	<function name="get_qitaodetail_by_sql" type="sql" sql="SELECT
																id,
																project,
																tracke,
																department,
																operator,
																create_time,
																oa_qi_tao_id
																FROM
																oa_qi_tao_detail
																 where 1=1 ${case}1 ">
		<parser index="1">
			<param fspname="oaQitaoId" sqlname="oa_qi_tao_id"></param>
		</parser>
	</function>


	<!--查询物流数据 -->
	<function name="get_oalogistics_by_sql" type="sql" sql="SELECT
																	id,logistics_num,logistics_company,
																	delivery_ple,delivery_num,delivery_time,
																	car_num,remarks,file_url,oa_order_id
																FROM
																oa_logistics
																 where 1=1 ${case}1 ">
		<parser index="1">
			<param fspname="oaOrderId" sqlname="oa_order_id"></param>
		</parser>
	</function>

	<!--查询物流数据 -->
	<function name="get_oaqa_by_sql" type="sql" sql="SELECT id,qualified_num_info,qualified_total FROM oa_qa where 1=1 ${case}1 ">
		<parser index="1">
			<param fspname="oaOrderId" sqlname="oa_order_id"></param>
		</parser>
	</function>

	<!-- 查询CQC节点的裁减数量信息 -->
	<function name="get_shear_num_by_sql" type="sql" sql="select ml.color, c.shear_num_info from oa_material_list ml left join oa_cqc c on ml.id = c.oa_material_list where 1=1 ${case}1">
		<parser index="1">
			<param fspname="oaOrderId" sqlname="ml.oa_order_id"></param>
		</parser>
	</function>

	<!-- 查询TPE车缝数量信息 -->
	<function name="get_sewing_num_info_by_eql" type="eql" sql="select vo from OaTpe vo where 1=1 ${case}1">
		<parser index="1">
			<param fspname="oaOrderId" sqlname="oaOrderId"></param>
		</parser>
	</function>

	<!-- 查询CQC的信息 -->
	<function name="get_cqc_info_by_eql" type="eql" sql="SELECT cqc.id, cqc.oa_material_list, cqc.apply_unit_num, cqc.receive_time, cqc.receive_num, cqc.receive_rate, cqc.receive_memo, cqc.loss_bundles, cqc.loss_other, cqc.loss_oddments, cqc.loss_memo, cqc.shear_num_info, cqc.loss_company, cqc.loss_yiyou, odhi.unit_num, odhi.need_num,oon.title FROM oa_cqc AS cqc INNER JOIN oa_material_list AS oml ON cqc.oa_material_list = oml.id INNER JOIN oa_order AS oo ON oml.oa_order_id = oo.id INNER JOIN oa_da_huo_info AS odhi ON odhi.oa_material_list = oml.id INNER JOIN oa_order_num AS oon ON oo.oa_order_num_id = oon.id where 1=1 ${case}1">
		<parser index="1">
			<param fspname="oaOrderId" sqlname="oo.id"></param>
		</parser>
	</function>

	<!-- 查询CQC齐套的信息 -->
	<function name="get_qitao_info_by_eql" type="eql" sql=" SELECT oo.sell_order_code, oo.style_code, oqt.qitao_receive_time, oqt.qitao_send_time, oqtd.project, oqtd.tracke, oqtd.department, oqtd.operator FROM oa_order AS oo INNER JOIN oa_qi_tao AS oqt ON oqt.oa_order_id = oo.id INNER JOIN oa_qi_tao_detail AS oqtd ON oqtd.oa_qi_tao_id = oqt.id where 1=1  ${case}1">
		<parser index="1">
			<param fspname="oaOrderId" sqlname="oo.id"></param>
		</parser>
	</function>

	<!-- 查询QA的信息  -->
	<function name="get_qa_info" type="sql" sql="SELECT qa.id, qa.oa_order_id, qa.qualified_num_info, qa.unqualified_num_info, qa.qualified_total, qa.unqualified_total, oon.title, oon.num_info ,ot.sewing_num FROM oa_order_num AS oon LEFT JOIN oa_order AS oo ON oo.oa_order_num_id = oon.id LEFT JOIN oa_qa AS qa ON oo.id = qa.oa_order_id LEFT JOIN oa_tpe As ot ON ot.oa_order_id = oo.id WHERE 1=1 ${case}1">
		<parser index="1">
			<param fspname="oaOrderId" sqlname="oo.id"></param>
		</parser>
	</function>

	<!--查看订单是否有退回 -->
	<function name="get_count_detail" type="sql" sql="select count(wf_step) as wf_step_num from oa_order_detail where wf_step='b_pur_confirm_4' ${case}1">
		<parser index="1">
			<param fspname="orderId" sqlname="oa_order"></param>
		</parser>
	</function>
	<!-- 获取要发送微信的客户 -->
	<function name="get_send_wechat_cus_by_sql_string" type="sql" sql="select oo.cus_id, oo.cus_code, oo.sell_order_id, oo.sell_order_code, oo.style_desc from oa_order_detail ood left join oa_order oo on ood.oa_order = oo.id where 1=1 ${case}1">
		<parser index="1">
			<param fspname="date1" sqlname="ood.wf_real_finish" op="&gt;="></param>
			<param fspname="date2" sqlname="ood.wf_real_finish" op="&lt;"></param>
			<param fspname="wf_step" sqlname="ood.wf_step"></param>
			<param fspname="type" sqlname="oo.type"></param>
		</parser>
	</function>
	
	<function name="get_order_list_excel_info" type="sql" sql="SELECT od.value,oo.id, oq.qualified_total, oq.unqualified_total, ot.sewing_total, ood.worker, ot.sewing_factory, ood.operator, oo.sell_order_code, oo.cus_name, oo.cloth_class, oo.style_class, ood.wf_step, ood.wf_step_duration, ood.wf_real_start,ood.wf_real_finish,oo.begin_time,oo.except_finish,oon.num_info FROM oa_order AS oo LEFT JOIN oa_order_detail AS ood ON ood.oa_order = oo.id LEFT JOIN oa_tpe AS ot ON ot.oa_order_id = oo.id LEFT JOIN oa_qa AS oq ON oq.oa_order_id = oo.id LEFT JOIN oa_dt AS od ON oo.cloth_class = od.code LEFT JOIN oa_order_num AS oon ON oo.oa_order_num_id = oon.id where $$ order by id asc,task_id asc">
	</function>
		
	<!-- 得到订单进度跟踪报表  -->
	<!-- by fangwei 2015-02-04 -->
	<function name="get_order_list_jindu_info" type="sql" sql="select * from (
	                                                        SELECT mian.*,
	                                                            cqdel_oa_order, cqdel_wf_step, cqdel_operator, cqdel_worker, cqdel_wf_real_start, cqdel_wf_real_finish, cqdel_wf_step_duration, jsdel_oa_order, jsdel_wf_real_start, jsdel_wf_real_finish,
	                                                            jsdel_wf_step, jsdel_operator, jsdel_worker, jsdel_wf_step_duration, jshdel_oa_order, jshdel_wf_step, jshdel_wf_real_start, jshdel_wf_real_finish,
	                                                            jshdel_operator, jshdel_wf_step_duration, cqcdel_oa_order, cqcdel_wf_step, cqcdel_operator, cqcdel_worker, cqc_wf_real_start, cqc_wf_real_finish,
	                                                            cqc_wf_step_duration, mr_oa_order, mr_if_repeat, mr_if_qualified, wldel_oa_order, wldel_wf_step, wldel_wf_real_start,
	                                                            wldel_wf_real_finish, mrdel_oa_order, mrdel_wf_step, mrdel_wf_real_start, mrdel_wf_real_finish, mrdel_operator,
                                                                mrdel_wf_step_duration, mrdb_oa_order, mrdb_wf_step, mrdb_wf_real_start, mrdb_wf_real_finish, mrdb_operator,
	                                                            mrdb_wf_step_duration, fidel_oa_order, fidel_wf_step, fidel_wf_real_start, fidel_operator, fidel_wf_real_finish, fidel_worker,
	                                                            fidel_wf_step_duration, ppcdel_oa_order, ppcdel_wf_step, ppcdel_wf_real_start, ppcdel_wf_real_finish, ppcdel_operator, ppcdel_worker,
	                                                            ppcdel_wf_step_duration, bqcdel_oa_order, bqcdel_wf_step, bqcdel_wf_real_start, bqcdel_wf_real_finish, bqcdel_operator, bqcdel_worker,
	                                                            bqcdel_wf_step_duration, tpedel_oa_order, tpedel_wf_step, tpedel_wf_real_start, tpedel_wf_real_finish, tpedel_operator, tpedel_worker,
	                                                            tpedel_wf_step_duration, cwdel_oa_order, cwdel_wf_step, cwdel_wf_real_start, cwdel_wf_real_finish, cwdel_operator, cwdel_worker,
	                                                            cwdel_wf_step_duration, wldel_wf_step_duration, wldel_worker, wldel_operator
                                                               FROM
	                                                            (
		                                                            SELECT oa.*, dt.value,
		                                                                tpe.sewing_factory, tpe.sewing_num, tpe.sewing_total, qa.qualified_num_info,
			                                                            qa.unqualified_num_info, qa.qualified_total, qa.unqualified_total, ml.num_info, cost.p_sam, qadel_oa_order, qadel_wf_step,
			                                                            qadel_operator, qadel_worker, qadel_wf_real_start, qadel_wf_real_finish, qadel_wf_step_duration
		                                                            FROM oa_order oa
		                                                            LEFT JOIN oa_tpe tpe ON oa.id = tpe.oa_order_id
		                                                            LEFT JOIN oa_qa qa ON oa.id = qa.oa_order_id
		                                                            LEFT JOIN oa_cost cost ON oa.id = cost.oa_order_id
		                                                            LEFT JOIN oa_order_num ml ON oa.oa_order_num_id = ml.id
		                                                            LEFT JOIN oa_dt dt on oa.cloth_class = dt.code
		                                                            LEFT JOIN(
                                                                        SELECT
                                                                            oa_order AS qadel_oa_order, wf_step AS qadel_wf_step, worker AS qadel_worker,
                                                                            operator AS qadel_operator, wf_real_start AS qadel_wf_real_start, wf_real_finish AS qadel_wf_real_finish,
                                                                            wf_step_duration as qadel_wf_step_duration
                                                                        FROM
                                                                            oa_order_detail
                                                                        WHERE
                                                                            wf_step = 'c_ppc_confirm_7' order by id desc
                                                                    )qadel ON oa.id = qadel.qadel_oa_order
	                                                            )mian
                                                                LEFT JOIN(
                                                                    SELECT
                                                                        oa_order AS cqdel_oa_order, wf_step AS cqdel_wf_step, worker AS cqdel_worker,
                                                                        wf_real_start AS cqdel_wf_real_start, wf_real_finish AS cqdel_wf_real_finish,
                                                                        operator AS cqdel_operator, wf_step_duration AS cqdel_wf_step_duration
                                                                    FROM
                                                                        oa_order_detail
                                                                    WHERE
                                                                        1 = 1
                                                                    AND wf_step = 'b_ppc_confirm_5' order by id desc
                                                                )cqdel ON mian.id = cqdel_oa_order
                                                                LEFT JOIN(
                                                                    SELECT
                                                                        oa_order AS jsdel_oa_order, wf_step AS jsdel_wf_step, worker AS jsdel_worker,
                                                                        wf_real_start AS jsdel_wf_real_start, wf_real_finish AS jsdel_wf_real_finish,
                                                                        operator AS jsdel_operator, wf_step_duration as jsdel_wf_step_duration
                                                                    FROM
                                                                        oa_order_detail
                                                                    WHERE
                                                                        1 = 1
                                                                    AND wf_step = 'b_pur_confirm_4' order by id desc
                                                                )jsdel ON mian.id = jsdel_oa_order
                                                                LEFT JOIN(
                                                                    SELECT
                                                                        oa_order AS jshdel_oa_order, wf_step AS jshdel_wf_step,
                                                                        wf_real_start AS jshdel_wf_real_start, wf_real_finish AS jshdel_wf_real_finish,
                                                                        operator AS jshdel_operator, wf_step_duration as jshdel_wf_step_duration
                                                                    FROM
                                                                        oa_order_detail
                                                                    WHERE
                                                                        1 = 1
                                                                    AND wf_step = 'c_ppc_assign_3' order by id desc
                                                                )jshdel ON mian.id = jshdel_oa_order
                                                                LEFT JOIN(
                                                                    SELECT
                                                                        oa_order AS cqcdel_oa_order, wf_step AS cqcdel_wf_step, worker AS cqcdel_worker,
                                                                        operator AS cqcdel_operator, wf_real_start AS cqc_wf_real_start, wf_real_finish AS cqc_wf_real_finish, wf_step_duration as cqc_wf_step_duration
                                                                    FROM
                                                                        oa_order_detail
                                                                    WHERE
                                                                        1 = 1
                                                                    AND wf_step = 'c_ppc_factoryMsg_5' order by id desc
                                                                )cqcdel ON mian.id = cqcdel_oa_order
                                                                LEFT JOIN(
                                                                    SELECT
                                                                        oa_order AS mr_oa_order, if_repeat AS mr_if_repeat,
                                                                        if_qualified AS mr_if_qualified
                                                                    FROM
                                                                        oa_mr_confirm
                                                                )mr ON mian.id = mr_oa_order
                                                                LEFT JOIN(
                                                                    SELECT
                                                                        oa_order AS wldel_oa_order, wf_step AS wldel_wf_step, wf_real_start AS wldel_wf_real_start,
                                                                        wf_real_finish AS wldel_wf_real_finish, wf_step_duration AS wldel_wf_step_duration,
                                                                        operator AS wldel_operator, worker AS wldel_worker
                                                                    FROM
                                                                        oa_order_detail
                                                                    WHERE
                                                                        1 = 1
                                                                    AND wf_step = 'c_ppc_confirm_9' order by id desc
                                                                )wldel ON mian.id = wldel_oa_order
                                                                LEFT JOIN(
                                                                    SELECT
                                                                        oa_order AS mrdel_oa_order, wf_step AS mrdel_wf_step,
                                                                        wf_real_start AS mrdel_wf_real_start, wf_real_finish AS mrdel_wf_real_finish,
                                                                        operator AS mrdel_operator,
                                                                        wf_step_duration AS mrdel_wf_step_duration
                                                                    FROM
                                                                        oa_order_detail
                                                                    WHERE
                                                                        1 = 1
                                                                    AND wf_step = 'c_mr_improve_2' order by id desc
                                                                )mrdel ON mian.id = mrdel_oa_order
                                                                LEFT JOIN(
                                                                    SELECT
                                                                        oa_order AS mrdb_oa_order, wf_step AS mrdb_wf_step,
                                                                        wf_real_start AS mrdb_wf_real_start, wf_real_finish AS mrdb_wf_real_finish, operator AS mrdb_operator,
                                                                        wf_step_duration AS mrdb_wf_step_duration
                                                                    FROM
                                                                        oa_order_detail
                                                                    WHERE
                                                                        1 = 1
                                                                    AND wf_step = 'b_mr_improve_2' order by id desc
                                                                )mrdb ON mian.id = mrdb_oa_order
                                                                LEFT JOIN(
                                                                    SELECT
                                                                        oa_order AS fidel_oa_order, wf_step AS fidel_wf_step,
                                                                        wf_real_start AS fidel_wf_real_start, wf_real_finish AS fidel_wf_real_finish, operator AS fidel_operator,
                                                                        worker AS fidel_worker, wf_step_duration AS fidel_wf_step_duration
                                                                    FROM
                                                                        oa_order_detail
                                                                    WHERE
                                                                        1 = 1
                                                                    AND wf_step = 'c_fi_pay_4' order by id desc
                                                                )fidel ON mian.id = fidel_oa_order
                                                                LEFT JOIN(
                                                                    SELECT
                                                                        oa_order AS ppcdel_oa_order, wf_step AS ppcdel_wf_step, worker AS ppcdel_worker,
                                                                        wf_real_start AS ppcdel_wf_real_start, wf_real_finish AS ppcdel_wf_real_finish, operator AS ppcdel_operator,
                                                                        wf_step_duration AS ppcdel_wf_step_duration
                                                                    FROM
                                                                        oa_order_detail
                                                                    WHERE
                                                                        1 = 1
                                                                    AND wf_step = 'b_ppc_confirm_3' order by id desc
                                                                )ppcdel ON mian.id = ppcdel_oa_order
                                                                LEFT JOIN(
                                                                    SELECT
                                                                        oa_order AS bqcdel_oa_order, wf_step AS bqcdel_wf_step, worker AS bqcdel_worker,
                                                                        wf_real_finish AS bqcdel_wf_real_finish, wf_real_start AS bqcdel_wf_real_start, operator AS bqcdel_operator,
                                                                        wf_step_duration as bqcdel_wf_step_duration
                                                                    FROM
                                                                        oa_order_detail
                                                                    WHERE
                                                                        1 = 1
                                                                    AND wf_step = 'b_qc_confirm_6' order by id desc
                                                                )bqcdel ON mian.id = bqcdel_oa_order
                                                                LEFT JOIN(
                                                                    SELECT
                                                                        oa_order AS tpedel_oa_order, wf_step AS tpedel_wf_step, wf_real_start AS tpedel_wf_real_start,
                                                                        wf_real_finish AS tpedel_wf_real_finish, operator AS tpedel_operator, worker AS tpedel_worker,
                                                                        wf_step_duration as tpedel_wf_step_duration
                                                                    FROM
                                                                        oa_order_detail
                                                                    WHERE
                                                                        1 = 1
                                                                    AND wf_step = 'c_qc_cutting_6' order by id desc
                                                                )tpedel ON mian.id = tpedel_oa_order
                                                                LEFT JOIN(
                                                                    SELECT
                                                                        oa_order AS cwdel_oa_order, wf_step AS cwdel_wf_step,
                                                                        wf_real_start AS cwdel_wf_real_start,
                                                                        wf_real_finish AS cwdel_wf_real_finish, operator AS cwdel_operator,
                                                                        wf_step_duration as cwdel_wf_step_duration,
                                                                        worker AS cwdel_worker
                                                                    FROM
                                                                        oa_order_detail
                                                                    WHERE
                                                                        1 = 1
                                                                    AND wf_step = 'c_qc_printing_8' order by id desc
                                                                )cwdel ON mian.id = cwdel_oa_order
                                                            WHERE
                                                                1 = 1 and  mian.STATUS = '0' ${case}1
                                                            GROUP BY
                                                                mian.id

                                                                ) fuck where 1=1 $$">
		<parser index="1">
			<param fspname="his_opt" sqlname="mian.his_opt" op="like"></param>
			<param fspname="type" sqlname="mian.type"></param>
			<param fspname="cus_name" sqlname="mian.cus_name" op="like"></param>
			<param fspname="style_code" sqlname="mian.style_code" op="like"></param>
			<param fspname="sewing_factory" sqlname="mian.sewing_factory" op="like"></param>
		</parser>
	</function>

	<!-- 查询每个节点的耗时  -->
	<function name="list_order_detail_time_by_sql" type="sql"
		sql="select a.* from (select wf_real_start,wf_real_finish,wf_step_duration,wf_step from oa_order_detail where 1=1 ${case}1  order by wf_real_start desc) a group by wf_step ">
		<parser index="1">
			<param fspname="orderId" sqlname="oa_order"></param>
		</parser>	
	</function>
	<!-- 品类模块 -->
	<!-- 查询品类列表 -->
	<function name="list_category_by_sql" type="sql" sql="SELECT oa_category.`name`,id,explain_txt,oa_category.`code`,oa_category.`status`,oa_category.dahuo_cyc,oa_category.daban_cyc
			FROM oa_category">
	</function>
	
	<!-- 查询品类列表for ALl -->
	<function name="list_category_all_by_sql" type="sql" sql="SELECT * FROM oa_category where 1=1 ${case}1">
		<parser index="1">
			<param fspname="style_class" sqlname="name"></param>
		</parser>
	</function>
	
	
	<!-- 获取15分钟内未处理的任务 -->
	<function name="get_oa_order_by_eql" type="eql" sql="select vo from OaOrder vo where 1=1">
	</function>
	
	<!-- 订单详细查询 -->
	<function name="list_oa_order_detail_order_by_eql" type="eql" sql="select vo from OaOrderDetail vo where 1=1 ${case}1 ">
		<parser index="1">
			<param fspname="oa_order" sqlname="oaOrder"></param>
		</parser>
	</function>


    <!-- 今日工作日报 -->
    <function name="get_today_report_by_sql" type="sql" sql="select group_concat(id) as ids, type, count(*) as num, SUM(want_cnt) as want_cnt  from oa_order where 1=1 ${case}1 GROUP BY type ORDER BY type">
        <parser index="1">
            <param fspname="begin_time" sqlname="begin_time"></param>
        </parser>
    </function>

    <!-- 今日工作日报2 -->
    <function name="get_today_report_orderDetail_by_sql" type="sql" sql="select * from oa_order_detail where 1=1 and ISNULL(back_flag)  ${case}1 $$">
        <parser index="1">
            <param fspname="type" sqlname="type"></param>
        </parser>
    </function>
</query>