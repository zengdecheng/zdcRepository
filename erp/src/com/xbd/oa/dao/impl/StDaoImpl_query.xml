<?xml version="1.0" encoding="UTF-8"?>
<query>
	<function name="list_oa_staff" type="sql"
		sql="select * from oa_staff  where 1=1 ${case}1 ">
		<parser index="1">
			<param fspname="login_name" sqlname="login_name" ></param>
			<param fspname="passwd" sqlname="password"></param>
			<param fspname="role" sqlname="oa_role"></param>
		</parser>
	</function>
	
	
	
	<!--   计算信息   -->
	<!-- 统计订单及时率  -->
	<function name="statistics_order_timerate_by_sql_1" type="sql"
		sql="select * from  oa_order where wf_step != 'finish_999' and type='3' and status = '0' ${case}1 ">
		<parser index="1">
<!-- 			<param fspname="time" sqlname="wf_real_start" op="&lt;="/> -->
			<param fspname="start_time" sqlname="wf_real_start" op="&gt;="/>
			<param fspname="wf_real_start" sqlname="wf_real_start" op="&gt;="/>
			<param fspname="lt_end_time" sqlname="end_time" op="&lt;=" ></param>
			<param fspname="gt_end_time" sqlname="end_time" op="&gt;=" ></param>
		</parser>
	</function>

	<function name="statistics_order_timerate_by_sql_2" type="sql"
		sql="select * from oa_order where wf_step = 'finish_999' ${case}1 and type='3' and status = '0' ">
		<parser index="1">
<!-- 			<param fspname="time" sqlname="end_time" op="&gt;="></param> -->
			<param fspname="start_time" sqlname="wf_real_start" op="&gt;="/>
			<param fspname="gt_end_time" sqlname="end_time" op="&gt;="/>
			<param fspname="lt_end_time" sqlname="end_time" op="&lt;="/>
		</parser>
	</function>
	
	<!-- 统计节点及时率  -->
	<function name="statistics_node_timerate_by_sql" type="sql"
		sql="select count(ood.id) times,ood.* from oa_order_detail ood,oa_order oo
			where 1=1 ${case}1 and ood.oa_order = oo.id and oo.type='3' and status='0' group by ood.oa_order ">
		<parser index="1">
			<param fspname="start" sqlname="ood.wf_real_start" op="&gt;="></param>
			<param fspname="step" sqlname="ood.wf_step" ></param>
		</parser>
	</function>
	
	<!-- 统计员工及时率 -->
	<function name="statistics_staff_timerate_by_sql" type="sql"
		sql="select  count(ood.id) times , ood.*,os.oa_org
				from oa_order_detail ood,oa_staff os ,oa_order oo
				where oo.status='0' and oo.type='3' and oo.id = ood.oa_order and ood.operator = os.login_name ${case}1  group by ood.oa_order,ood.wf_step order by ood.oa_order ">
		<parser index="1">
			<param fspname="operator" sqlname="ood.operator"></param>
			<param fspname="start" sqlname="ood.wf_real_start" op="&gt;="></param>
		</parser>
	</function>
	
	<!-- 统计当前超时订单   实时统计-->
	<function name="statistics_timeout_order_by_sql" type="sql"
			sql="select ood.*,os.oa_org,oo.style_code,oo.cus_code from oa_order_detail ood,oa_staff os,oa_order oo where 1=1 ${case}1 and ood.wf_real_finish is null and ood.oa_order = oo.id and ood.operator = os.login_name and oo.status='0' and oo.type='3' ">
		<parser index="1">
			<param fspname="orderId" sqlname="oa_order"></param>
			<param fspname="start_time" sqlname="ood.wf_real_start" op="&gt;="/>
			<param fspname="end_time" sqlname="ood.wf_real_start" op="&lt;="/>
		</parser>
	</function>
	
	
	<!--   提取信息  -->
	
	
	
	<!-- 获取节点及时率  -->
	<function name="get_node_timerate_this_week_by_sql" type="sql"
		sql="select * from time_rate_node where 1=1 ${case}1 ">
		<parser index="1">
			<param fspname="weekNo" sqlname="week_no"></param>
			<param fspname="dayWeek" sqlname="day_week"></param>
		</parser>
	</function>
	
	<!-- 获取流程操作人  -->
	<function name="get_operator_by_sql" type="sql"
		sql="select distinct ood.operator,os.oa_org 
		from oa_order_detail ood,oa_staff os,oa_order oo 
		where 1=1 ${case}1 and os.login_name = ood.operator and oo.status='0' and oo.type='3' and oo.id = ood.oa_order ">
		<parser index="1">
			<param fspname="start" sqlname="ood.wf_real_start" op="&gt;="></param>
		</parser>
	</function>
	
	<!-- 获取员工及时率  -->
	<function name="get_staff_timerate_by_sql" type="sql"
		sql="select * from time_rate_staff where 1=1 ${case}1 ">
		<parser index="1">
			<param fspname="staff" sqlname="operator" ></param>
			<param fspname="weekNo" sqlname="week_no" />
		</parser>
	</function>
	
	<!-- 获取节点及时率详情  wf_real_finish -->
	<function name="get_node_timerate_detail_by_sql" type="sql" 
		sql="select ood.*,oo.style_code,oo.cus_code,oo.except_finish,os.oa_org from time_rate_ood ood,time_rate_oo oo,oa_staff os where ood.oa_order = oo.id and oo.status='0' and oo.type='3' and ood.operator = os.login_name ${case}1 ">
		<parser index="1">
			<param fspname="nodeCode" sqlname="ood.wf_step" ></param>
			<param fspname="staff" sqlname="ood.operator" ></param>
			<param fspname="start" sqlname="ood.wf_real_start" op="&gt;="></param>
			<param fspname="start_wf_real_finish" sqlname="ood.wf_real_finish" op="&gt;="/>
			<param fspname="end_wf_real_finish" sqlname="ood.wf_real_finish" op="&lt;="/>
		</parser>
	</function>
	
	<!-- 获取员工及时率详情  -->
	
	<!-- 获取订单详情  -->
	<function name="get_oa_order_detail_by_sql" type="sql"
		sql="select ood.*,os.oa_org from time_rate_ood ood ,oa_staff os where 1=1 ${case}1 and ood.operator = os.login_name ">
		<parser index="1">
			<param fspname="orderId" sqlname="ood.oa_order"></param>
		</parser>	
	</function>
	
<!-- 	本周 订单详情（实时） -->
	<function name="get_oa_order_detail_now_by_sql" type="sql"
		sql="select ood.*,os.oa_org from oa_order_detail ood ,oa_staff os where 1=1 ${case}1 and ood.operator = os.login_name ">
		<parser index="1">
			<param fspname="orderId" sqlname="ood.oa_order"></param>
			<param fspname="step" sqlname="ood.wf_step"></param>
			<param fspname="operator" sqlname="ood.operator"></param>
<!-- 			<param fspname="time" sqlname="ood.wf_real_start" /> -->
			<param fspname="start_time" sqlname="ood.wf_real_start" op="&gt;="/>
			<param fspname="end_time" sqlname="ood.wf_real_start" op="&lt;="/>
		</parser>	
	</function>
	
	<!-- 获取周订单及时率  -->
	<function name="get_oa_order_week_timerate_by_sql" type="sql"
		sql="select * from time_rate_week where 1=1 ${case}1 ">
		<parser index="1">
			<param fspname="weekNo" sqlname="week_no"></param>
		</parser>
	</function>
	
	<function name="get_oa_order_week_timerate_by_eql" type="eql"
		sql="select vo from TimeRateWeek vo where 1=1 ${case}1 ">
		<parser index="1">
			<param fspname="weekNo" sqlname="week_no"></param>
		</parser>
	</function>
	
	<function name="get_oa_order_detail_step_duration_by_eql" type="sql"
		sql="select wf_step_duration from oa_order_detail  where 1=1 ${case}1 ">
		<parser index="1">
			<param fspname="orderId" sqlname="oa_order"></param>
			<param fspname="operator" sqlname="operator"></param>
		</parser>
	</function>
	
</query>